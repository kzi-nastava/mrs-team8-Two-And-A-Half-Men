import{a as S}from"./chunk-N5ONJPTC.js";import{a as y,b as R,c as T}from"./chunk-ZZU5WPUM.js";import"./chunk-PBSO56S7.js";import{a as O}from"./chunk-6HEX5QYM.js";import{a as w}from"./chunk-QXKYPX7G.js";import{f as M}from"./chunk-DMUBA5XY.js";import{b as k}from"./chunk-GX4BJWGY.js";import{a as f}from"./chunk-WZWIJEA2.js";import{Ac as P,Ha as c,Hb as m,K as x,P as a,Va as C,W as v,Za as _,fa as p,kb as d,lb as n,mb as r,nb as b,wb as l}from"./chunk-GHGVHUHC.js";import{g as h}from"./chunk-TSRGIXR5.js";var u=class i{http=a(P);loadActiveRides(e){return this.http.get(`api/${f.apiVersion}/rides/active`,{params:{name:e}})}loadPanics(){return this.http.get(`api/${f.apiVersion}/rides/panics`)}static \u0275fac=function(s){return new(s||i)};static \u0275prov=x({token:i,factory:i.\u0275fac,providedIn:"root"})};function F(i,e){i&1&&(v(),n(0,"svg",12),b(1,"path",13),r())}function I(i,e){i&1&&(v(),n(0,"svg",14),b(1,"g",15)(2,"g",16),n(3,"g",17),b(4,"path",18)(5,"path",19)(6,"path",20),r()())}var A=class i{tabs=[{id:"active-rides",label:"Active Rides"},{id:"panics",label:"Panics"}];activeTab=p("active-rides");setActiveTab(e){this.activeTab.set(e)}panics=p([]);rides=p([]);driverNameFilter=p("");loading=p(!1);adminHomepageService=a(u);popupsService=a(k);router=a(M);webSocketService=a(O);unsubscribeFn=null;rideConfig={showDriverInfo:!0,showPassengerInfo:!0,showPanicButton:!0,showInconsistencyReports:!0,showRatings:!0,showReorderOption:!0,canViewDetails:!0,showUserFilters:!0,showRateButton:!1};ngOnInit(){this.loadRides(),this.subscribeToRideUpdates()}loadRides(){this.loading.set(!0),this.adminHomepageService.loadActiveRides(this.driverNameFilter()).subscribe({next:e=>{this.rides.set(e),this.loading.set(!1)},error:e=>{this.popupsService.error("Error loading active rides",e?.error?.message||"There was an error loading active rides. Please try again later."),this.rides.set([])}}),this.adminHomepageService.loadPanics().subscribe({next:e=>{this.panics.set(e)},error:e=>{this.popupsService.error("Error loading panics",e?.error?.message||"There was an error loading panics. Please try again later."),this.panics.set([])}})}onRideClick(e){this.router.navigate(["rides",e.id]).then()}subscribeToRideUpdates(){return h(this,null,function*(){try{this.unsubscribeFn=yield this.webSocketService.subscribe("/topic/panic",e=>{console.log("Received panic notification:",e),this.loadRides()})}catch(e){console.error("[PanicService] Error subscribing to panic:",e)}})}unsubscribeFromRideUpdates(){try{this.unsubscribeFn&&(this.unsubscribeFn(),this.unsubscribeFn=null)}catch(e){console.error("[PanicService] Error unsubscribing from panic:",e)}}ngOnDestroy(){this.unsubscribeFromRideUpdates()}static \u0275fac=function(s){return new(s||i)};static \u0275cmp=C({type:i,selectors:[["app-driver-home-page"]],decls:20,vars:12,consts:[[1,"ride-active-container"],[3,"tabChange","activeTab","alignment","tabs"],["appTabIcon","active-rides"],["appTabIcon","panics"],["tabId","active-rides",3,"activeTab"],[1,"active-header"],["appBox","",1,"chat-input-container",2,"margin-bottom","1rem"],["type","text","placeholder","Type text...",1,"chat-input",3,"input","keyup.enter","value"],[1,"send-btn",3,"click"],[3,"rideClick","rides","config","loading"],["tabId","panics",3,"activeTab"],[1,"subheader"],["width","25","height","25","viewBox","0 0 24 24","fill","none"],["d","M5 17h14M5 17a2 2 0 1 1 0-4M5 17a2 2 0 1 0 0-4m14 4a2 2 0 1 0 0-4m0 4a2 2 0 1 1 0-4M3 11l2-7h14l2 7M5 13h14","stroke","currentColor","stroke-width","2"],["width","25","height","25","viewBox","0 0 24 24","fill","none","xmlns","http://www.w3.org/2000/svg"],["id","SVGRepo_bgCarrier","stroke-width","0"],["id","SVGRepo_tracerCarrier","stroke-linecap","round","stroke-linejoin","round"],["id","SVGRepo_iconCarrier"],["d","M2.20164 18.4695L10.1643 4.00506C10.9021 2.66498 13.0979 2.66498 13.8357 4.00506L21.7984 18.4695C22.4443 19.6428 21.4598 21 19.9627 21H4.0373C2.54022 21 1.55571 19.6428 2.20164 18.4695Z","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["d","M12 9V13","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["d","M12 17.0195V17","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"]],template:function(s,t){s&1&&(n(0,"div",0)(1,"app-tab-navigation",1),l("tabChange",function(o){return t.setActiveTab(o)}),_(2,F,2,0,"ng-template",2)(3,I,7,0,"ng-template",3),r(),n(4,"app-tab-content",4)(5,"div",5)(6,"h2"),m(7,"Currently active rides"),r()(),n(8,"div",6)(9,"input",7),l("input",function(o){return t.driverNameFilter.set(o.target.value)})("keyup.enter",function(){return t.loadRides()}),r(),n(10,"button",8),l("click",function(){return t.loadRides()}),m(11,"Filter"),r()(),n(12,"app-rides-list",9),l("rideClick",function(o){return t.onRideClick(o)}),r()(),n(13,"app-tab-content",10)(14,"div",5)(15,"h2"),m(16,"Panics"),r(),n(17,"p",11),m(18,"List of all panics that occurred during rides"),r()(),n(19,"app-rides-list",9),l("rideClick",function(o){return t.onRideClick(o)}),r()()()),s&2&&(c(),d("activeTab",t.activeTab())("alignment","left")("tabs",t.tabs),c(3),d("activeTab",t.activeTab()),c(5),d("value",t.driverNameFilter()),c(3),d("rides",t.rides())("config",t.rideConfig)("loading",t.loading()),c(),d("activeTab",t.activeTab()),c(6),d("rides",t.panics())("config",t.rideConfig)("loading",t.loading()))},dependencies:[T,R,y,S,w],styles:["[_nghost-%COMP%]{--primary-green: #2d5a3d;--dark-bg: #2a2a2a;--card-bg: #3a3a3a;--accent-green: #4a9d5f;--light-green: #5cb85c;--text-light: #e0e0e0;--text-muted: #999;--border-color: #4a4a4a}.ride-active-container[_ngcontent-%COMP%]{padding:20px;max-width:1200px;margin:0 auto;background-color:var(--dark-bg);min-height:100vh;color:var(--text-light)}h2[_ngcontent-%COMP%]{margin-bottom:24px;color:var(--text-light)}.active-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;flex-wrap:wrap;gap:15px;padding:20px;background-color:var(--primary-green);border-radius:8px;box-shadow:0 2px 8px #0000004d}.active-controls[_ngcontent-%COMP%]{display:flex;gap:12px;flex-wrap:wrap}.sort-field-select[_ngcontent-%COMP%], .page-size-select[_ngcontent-%COMP%]{padding:8px 12px;border:1px solid var(--border-color);border-radius:6px;background-color:var(--card-bg);color:var(--text-light);cursor:pointer;font-size:14px;transition:all .2s}.sort-field-select[_ngcontent-%COMP%]:hover, .page-size-select[_ngcontent-%COMP%]:hover{border-color:var(--accent-green)}.sort-field-select[_ngcontent-%COMP%]   option[_ngcontent-%COMP%], .page-size-select[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]{background-color:var(--card-bg);color:var(--text-light)}.btn-sort[_ngcontent-%COMP%], .btn-filter[_ngcontent-%COMP%]{padding:8px 16px;background-color:var(--card-bg);color:var(--text-light);border:1px solid var(--border-color);border-radius:6px;cursor:pointer;transition:all .2s;font-size:14px;font-weight:600}.btn-sort[_ngcontent-%COMP%]:hover, .btn-filter[_ngcontent-%COMP%]:hover{background-color:#4a4a4a;border-color:var(--accent-green)}.filters-panel[_ngcontent-%COMP%]{background-color:var(--card-bg);border:1px solid var(--border-color);border-radius:8px;padding:20px;margin-bottom:20px;display:flex;gap:15px;flex-wrap:wrap;align-items:flex-end}.filter-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:5px;min-width:200px}.filter-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:14px;font-weight:600;color:var(--text-muted);text-transform:uppercase;letter-spacing:1px}.date-input[_ngcontent-%COMP%]{padding:8px 12px;border:1px solid var(--border-color);border-radius:6px;font-size:14px;background-color:var(--dark-bg);color:var(--text-light);transition:all .2s}.date-input[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--accent-green)}.filter-actions[_ngcontent-%COMP%]{display:flex;gap:10px}.btn-apply[_ngcontent-%COMP%], .btn-clear[_ngcontent-%COMP%]{padding:8px 16px;border:none;border-radius:6px;cursor:pointer;font-size:14px;font-weight:600;transition:all .2s}.btn-apply[_ngcontent-%COMP%]{background-color:var(--light-green);color:#fff}.btn-apply[_ngcontent-%COMP%]:hover{background-color:var(--accent-green);transform:translateY(-2px)}.btn-clear[_ngcontent-%COMP%]{background-color:var(--card-bg);color:var(--text-light);border:1px solid var(--border-color)}.btn-clear[_ngcontent-%COMP%]:hover{background-color:#4a4a4a;border-color:#8b3a3a}.pagination[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;gap:16px;margin-top:24px;padding:16px;background-color:var(--card-bg);border-radius:8px;border:1px solid var(--border-color)}.btn-pagination[_ngcontent-%COMP%]{padding:8px 16px;background-color:var(--light-green);color:#fff;border:none;border-radius:6px;cursor:pointer;transition:all .2s;font-weight:600}.btn-pagination[_ngcontent-%COMP%]:hover:not(:disabled){background-color:var(--accent-green);transform:translateY(-2px)}.btn-pagination[_ngcontent-%COMP%]:disabled{background-color:#5a5a5a;cursor:not-allowed;opacity:.5}.pagination-info[_ngcontent-%COMP%]{font-size:14px;color:var(--text-light)}.page-size-select[_ngcontent-%COMP%]{padding:6px 12px;border:1px solid var(--border-color);border-radius:4px;cursor:pointer}@media(max-width:768px){.active-header[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch}.active-controls[_ngcontent-%COMP%], .filters-panel[_ngcontent-%COMP%]{flex-direction:column}.filter-group[_ngcontent-%COMP%]{min-width:100%}}chat-input-container[_ngcontent-%COMP%]{padding:16px;border-top:1px solid #3a3a3a;display:flex;gap:1rem}.chat-input[_ngcontent-%COMP%]{flex:1;background:transparent;border:1px solid #4a4a4a;border-radius:4px;padding:10px 12px;color:#fff;font-size:13px}.chat-input[_ngcontent-%COMP%]::placeholder{color:#888}.chat-input[_ngcontent-%COMP%]:focus{outline:none;border-color:#1a5c3a}.send-btn[_ngcontent-%COMP%]{background:#1a5c3a;color:#fff;border:none;border-radius:4px;padding:10px 24px;cursor:pointer;font-size:13px;font-weight:600;transition:background .2s}.send-btn[_ngcontent-%COMP%]:hover{background:#236b48}.send-btn[_ngcontent-%COMP%]:active{background:#154a30}"]})};export{A as AdminHomePageComponent};
