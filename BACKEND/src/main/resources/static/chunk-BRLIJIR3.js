import{a as W,b as X,c as Y,e as Z}from"./chunk-SPPU3CU2.js";import"./chunk-PBSO56S7.js";import"./chunk-6HEX5QYM.js";import{b as H,c as j,d as G,e as B,i as $,l as A,m as q,t as K,v as U}from"./chunk-OXPWAMAC.js";import{i as V}from"./chunk-DMUBA5XY.js";import{b as J}from"./chunk-GX4BJWGY.js";import"./chunk-WZWIJEA2.js";import{Ac as b,E as x,Ec as R,Ha as m,Hb as l,Jb as k,K as L,O as T,P as D,Qa as u,U as P,V as O,Va as _,d as C,eb as w,fa as p,fb as E,ga as h,ib as F,jb as N,kb as g,lb as s,mb as r,nb as z,sc as I,ub as Q,w as y,wb as d,y as M,yb as f}from"./chunk-GHGVHUHC.js";import"./chunk-TSRGIXR5.js";var v=class o{constructor(e){this.http=e}estimateTime(e,t){let i={routeId:null,route:[{address:e.display_name,latitude:e.lat,longitude:e.lon},{address:t.display_name,latitude:t.lat,longitude:t.lon}]};return console.log("Booking Params:",i),this.http.post("/api/v1/rides/estimates",i)}static \u0275fac=function(t){return new(t||o)(T(b))};static \u0275prov=L({token:o,factory:o.\u0275fac,providedIn:"root"})};var et=(o,e)=>e.place_id;function st(o,e){if(o&1){let t=Q();s(0,"div",13),d("mousedown",function(){let a=P(t).$implicit,c=f(2);return O(c.selectStartSuggestion(a))}),l(1),r()}if(o&2){let t=e.$implicit;m(),k(" ",t.display_name," ")}}function at(o,e){if(o&1&&(s(0,"div",6),F(1,st,2,1,"div",12,et),r()),o&2){let t=f();m(),N(t.startSuggestions())}}function mt(o,e){if(o&1){let t=Q();s(0,"div",13),d("mousedown",function(){let a=P(t).$implicit,c=f(2);return O(c.selectEndSuggestion(a))}),l(1),r()}if(o&2){let t=e.$implicit;m(),k(" ",t.display_name," ")}}function ct(o,e){if(o&1&&(s(0,"div",6),F(1,mt,2,1,"div",12,et),r()),o&2){let t=f();m(),N(t.endSuggestions())}}var S=class o{constructor(e,t,i,a,c){this.fb=e;this.http=t;this.sharedLocationsService=i;this.estimateService=a;this.nominatimService=c;this.estimateForm=this.fb.group({startpoint:["",j.required],endpoint:["",j.required]}),this.startQuerySubject.pipe(y(500),M(),x(n=>n.length>3?this.searchLocation(n):[])).subscribe(n=>{if(n.length===1&&this.startQuery()===n[0].display_name){this.showStartSuggestions.set(!1);return}this.startSuggestions.set(n),this.showStartSuggestions.set(n.length>0)}),this.endQuerySubject.pipe(y(500),M(),x(n=>n.length>3?this.searchLocation(n):[])).subscribe(n=>{if(n.length===1&&this.endQuery()===n[0].display_name){this.showEndSuggestions.set(!1);return}this.endSuggestions.set(n),this.showEndSuggestions.set(n.length>0)}),h(()=>{let n=this.startQuery();n.length>3?this.startQuerySubject.next(n):(this.startSuggestions.set([]),this.showStartSuggestions.set(!1))}),h(()=>{let n=this.endQuery();n.length>3?this.endQuerySubject.next(n):(this.endSuggestions.set([]),this.showEndSuggestions.set(!1))}),h(()=>{let n=this.sharedLocationsService.locations();if(!this.suppressLocationSync){if(n.length>2){this.sharedLocationsService.locations.set([n[0],n[n.length-1]]);return}n.length===2?(this.startQuery.set(n[0].display_name),this.endQuery.set(n[1].display_name),this.estimateForm.patchValue({startpoint:n[0].display_name,endpoint:n[1].display_name})):n.length===1?(this.startQuery.set(n[0].display_name),this.endQuery.set(""),this.estimateForm.patchValue({startpoint:n[0].display_name,endpoint:""})):(this.startQuery.set(""),this.endQuery.set(""),this.estimateForm.patchValue({startpoint:"",endpoint:""}))}})}estimateForm;startQuery=p("");endQuery=p("");startSuggestions=p([]);endSuggestions=p([]);showStartSuggestions=p(!1);showEndSuggestions=p(!1);startQuerySubject=new C;endQuerySubject=new C;popupsService=D(J);suppressLocationSync=!1;searchLocation(e){return this.nominatimService.search(e,5)}selectStartSuggestion(e){this.startQuery.set(e.display_name),this.estimateForm.patchValue({startpoint:e.display_name}),this.showStartSuggestions.set(!1),this.startSuggestions.set([]),this.suppressLocationSync=!0,this.sharedLocationsService.locations.update(t=>{let i=t[1]??t[t.length-1];return i?[e,i]:[e]}),this.suppressLocationSync=!1}selectEndSuggestion(e){this.endQuery.set(e.display_name),this.estimateForm.patchValue({endpoint:e.display_name}),this.showEndSuggestions.set(!1),this.endSuggestions.set([]),this.suppressLocationSync=!0,this.sharedLocationsService.locations.update(t=>{let i=t[0];return i?[i,e]:[e]}),this.suppressLocationSync=!1}onSubmit(){if(!this.estimateForm.valid){console.log("Form is invalid");return}let e=this.sharedLocationsService.locations();if(e.length<2){this.popupsService.error("Missing Locations","Please select both a start and end location.");return}let[t,i]=e;this.estimateService.estimateTime(t,i).subscribe({next:a=>{this.popupsService.success("Estimated Time",`The estimated time for your ride is ${Math.ceil(a.time)} minutes.`)},error:a=>{this.popupsService.error("Estimation Failed",a.error?.error||"An error occurred while estimating your ride time. Please try again.")}})}onBlur(e){setTimeout(()=>{e==="start"?this.showStartSuggestions.set(!1):this.showEndSuggestions.set(!1)},200)}onReset(){this.estimateForm.reset(),this.startQuery.set(""),this.endQuery.set(""),this.startSuggestions.set([]),this.endSuggestions.set([]),this.showStartSuggestions.set(!1),this.showEndSuggestions.set(!1),this.sharedLocationsService.locations.set([])}ngOnDestroy(){this.startQuerySubject.complete(),this.endQuerySubject.complete()}static \u0275fac=function(t){return new(t||o)(u(K),u(b),u(X),u(v),u(W))};static \u0275cmp=_({type:o,selectors:[["app-estimate-form"]],decls:20,vars:5,consts:[[1,"window"],[1,"estimate-form",3,"ngSubmit","formGroup"],[1,"estimate-form-container"],[1,"form-group"],["type","text","id","start","formControlName","startpoint","placeholder"," ","autocomplete","off",3,"input","blur","value"],["for","start"],[1,"autocomplete-dropdown"],["type","text","id","end","formControlName","endpoint","placeholder"," ","autocomplete","off",3,"input","blur","value"],["for","end"],[1,"button-container"],["type","submit",1,"submit-btn"],["type","button",1,"reset-btn",3,"click"],[1,"autocomplete-item"],[1,"autocomplete-item",3,"mousedown"]],template:function(t,i){t&1&&(s(0,"div",0)(1,"form",1),d("ngSubmit",function(){return i.onSubmit()}),s(2,"div",2)(3,"h2"),l(4,"Estimate Time for Route"),r(),s(5,"div",3)(6,"input",4),d("input",function(c){return i.startQuery.set(c.target.value)})("blur",function(){return i.onBlur("start")}),r(),s(7,"label",5),l(8,"Start Point"),r(),w(9,at,3,0,"div",6),r(),s(10,"div",3)(11,"input",7),d("input",function(c){return i.endQuery.set(c.target.value)})("blur",function(){return i.onBlur("end")}),r(),s(12,"label",8),l(13,"End Point"),r(),w(14,ct,3,0,"div",6),r(),s(15,"div",9)(16,"button",10),l(17,"Get Estimate"),r(),s(18,"button",11),d("click",function(){return i.onReset()}),l(19,"Reset"),r()()()()()),t&2&&(m(),g("formGroup",i.estimateForm),m(5),g("value",i.startQuery()),m(3),E(i.showStartSuggestions()?9:-1),m(2),g("value",i.endQuery()),m(3),E(i.showEndSuggestions()?14:-1))},dependencies:[U,$,H,G,B,q,A,I,V,R],styles:[".window[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100vh;background-color:#322d2b;border-radius:5px;padding:20px;border:.1rem solid #1C6331;width:100%}.estimate-form[_ngcontent-%COMP%]{z-index:2;display:flex;width:100%;flex-direction:column;justify-content:space-evenly;height:80%;background-color:#322d2b;font-size:1.5rem;color:#fff}.estimate-form[_ngcontent-%COMP%]   .estimate-form-container[_ngcontent-%COMP%]{flex:1}.estimate-form[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{text-align:center;border-bottom:#fff .1rem solid;margin-left:10px;margin-right:10px;margin-bottom:5rem}.estimate-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{margin-left:10%;width:80%;margin-bottom:1rem;position:relative;height:4rem}.estimate-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{position:absolute;top:.3rem;left:.5rem;color:#aaa;pointer-events:none;transition:all .2s ease-out}.estimate-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;border:none;padding:.3rem;border-radius:10px;border:#1C6331 .1rem solid;height:2rem;font-size:1.5rem}.estimate-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none;border:#1C6331 .2rem solid}.estimate-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus + label[_ngcontent-%COMP%], .estimate-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:not(:placeholder-shown) + label[_ngcontent-%COMP%]{top:-.9rem;font-size:.75rem;color:#fff}.autocomplete-dropdown[_ngcontent-%COMP%]{position:absolute;top:100%;left:0;right:0;background-color:#322d2b;border:.1rem solid #1C6331;border-radius:5px;margin-top:5px;max-height:300px;overflow-y:auto;z-index:1000;box-shadow:0 4px 6px #0000004d}.autocomplete-item[_ngcontent-%COMP%]{padding:10px 15px;color:#fff;cursor:pointer;border-bottom:1px solid #444;font-size:1rem;transition:background-color .2s}.autocomplete-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.autocomplete-item[_ngcontent-%COMP%]:hover{background-color:#1c6331}.autocomplete-dropdown[_ngcontent-%COMP%]::-webkit-scrollbar{width:8px}.autocomplete-dropdown[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#222121;border-radius:5px}.autocomplete-dropdown[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#1c6331;border-radius:5px}.autocomplete-dropdown[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#145224}.estimate-form[_ngcontent-%COMP%]   .button-container[_ngcontent-%COMP%]{flex:2;display:flex;flex-direction:column;justify-content:center;align-items:center}.estimate-form[_ngcontent-%COMP%]   .submit-btn[_ngcontent-%COMP%]{width:80%;background-color:#1c6331;color:#fff;border:none;border-radius:5px;font-size:2rem;cursor:pointer;padding:.5rem}.estimate-form[_ngcontent-%COMP%]   .reset-btn[_ngcontent-%COMP%]{width:80%;background-color:#d8d514;color:#fff;border:none;border-radius:5px;font-size:2rem;cursor:pointer;padding:.5rem;margin-top:1rem}.estimate-form[_ngcontent-%COMP%]   .submit-btn[_ngcontent-%COMP%]:hover{background-color:#145224}small[_ngcontent-%COMP%]{color:#ff4d4d;font-size:12px;display:block;margin-top:5px}.main[_ngcontent-%COMP%]{height:100vh;display:flex;justify-content:space-evenly;align-items:flex-end;background-color:#222121}@media(max-width:768px){.estimate-form[_ngcontent-%COMP%]{width:80%}.main[_ngcontent-%COMP%]{align-items:center}.estimate-form[_ngcontent-%COMP%]{justify-content:center;font-size:1rem}.estimate-form[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin-bottom:3rem}.estimate-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{font-size:1rem;height:1rem}.estimate-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{height:3.2rem}.autocomplete-item[_ngcontent-%COMP%]{font-size:.85rem;padding:8px 12px}.autocomplete-dropdown[_ngcontent-%COMP%]{max-height:200px}}.result-container[_ngcontent-%COMP%]{margin-top:2rem;text-align:center;font-size:1.5rem;color:#fff}.result-container[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-bottom:1rem;font-size:2rem;background-color:#d8d514;padding:.5rem;border-radius:5px}"]})};var nt=class o{mapConfig=Y;static \u0275fac=function(t){return new(t||o)};static \u0275cmp=_({type:o,selectors:[["app-home-page"]],decls:3,vars:1,consts:[[1,"home-page"],[3,"config"]],template:function(t,i){t&1&&(s(0,"div",0),z(1,"app-estimate-form")(2,"app-map",1),r()),t&2&&(m(2),g("config",i.mapConfig))},dependencies:[S,Z],styles:[".home-page[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;padding:20px;box-sizing:border-box;height:calc(100vh - 60px)}app-estimate-form[_ngcontent-%COMP%]{flex:1;margin-right:10px}app-map[_ngcontent-%COMP%]{flex:2;margin-left:10px}"]})};export{nt as HomePage};
