<!-- src/app/components/profile/profile.component.html -->

<div class="profile-container">

	<!-- Main Content -->
	<div class="profile-content">

		<!-- Add this section in profile.component.html right before the tab-navigation div -->

		<!-- Pending Review Alert -->
		<div class="pending-review-alert">
			<div class="alert-icon">
				<svg width="24" height="24" viewBox="0 0 24 24" fill="none">
					<circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
					<path d="M12 8v4M12 16h.01" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
				</svg>
			</div>
			<div class="alert-content">
				<h4 class="alert-title">Pending Review</h4>
				<p class="alert-message">Your profile changes are currently under review by the administrator. You will be notified once they are approved.</p>
				<div class="pending-changes-list">
					<div class="pending-item">
						<span class="change-field">Phone number:</span>
						<span class="change-value">+381641234567 → +381641234999</span>
					</div>
					<div class="pending-item">
						<span class="change-field">Vehicle model:</span>
						<span class="change-value">Fiat Punto → Toyota Corolla</span>
					</div>
				</div>
			</div>
			<button class="cancel-button">
				<svg width="16" height="16" viewBox="0 0 24 24" fill="none">
					<path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
				</svg>
				Cancel Request
			</button>
		</div>
		<!-- Tab Navigation -->
		<div class="tab-navigation">
			<button
				class="tab-button"
				[class.active]="activeTab() === 'personal'"
				(click)="setActiveTab('personal')">
				<svg width="20" height="20" viewBox="0 0 24 24" fill="none">
					<path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2M12 11a4 4 0 1 0 0-8 4 4 0 0 0 0 8z" stroke="currentColor" stroke-width="2"/>
				</svg>
				<span>Personal data</span>
			</button>
			<button
				class="tab-button"
				[class.active]="activeTab() === 'vehicle'"
				(click)="setActiveTab('vehicle')">
				<svg width="20" height="20" viewBox="0 0 24 24" fill="none">
					<path d="M5 17h14M5 17a2 2 0 1 1 0-4M5 17a2 2 0 1 0 0-4m14 4a2 2 0 1 0 0-4m0 4a2 2 0 1 1 0-4M3 11l2-7h14l2 7M5 13h14" stroke="currentColor" stroke-width="2"/>
				</svg>
				<span>Vehicle data</span>
			</button>
		</div>

		<!-- Save Message -->
		@if (saveMessage()) {
			<div class="save-message">{{ saveMessage() }}</div>
		}

		<!-- Personal Data Tab -->
		@if (activeTab() === 'personal') {
			<div class="tab-content">
				<div class="form-section">
					<div class="form-grid">
						<div class="form-column">
							<div class="form-group">
								<label for="firstName">First name</label>
								<input
									type="text"
									id="firstName"
									[(ngModel)]="userForm().firstName"
									class="form-input">
							</div>

							<div class="form-group">
								<label for="lastName">Last Name</label>
								<input
									type="text"
									id="lastName"
									[(ngModel)]="userForm().lastName"
									class="form-input">
							</div>

							<div class="form-group">
								<label for="phone">Phone number</label>
								<input
									type="tel"
									id="phone"
									[(ngModel)]="userForm().phoneNumber"
									class="form-input">
							</div>

							<div class="form-group">
								<label for="address">Address</label>
								<input
									type="text"
									id="address"
									[(ngModel)]="userForm().address"
									class="form-input">
							</div>

							<div class="form-group">
								<label for="email">Email</label>
								<input
									type="email"
									id="email"
									[(ngModel)]="userForm().email"
									class="form-input">
							</div>
						</div>

						<div class="photo-column">
							<div class="photo-container">
								<img [src]="userForm().photoUrl || 'assets/default-avatar.jpg'" alt="Profile Photo">
								<button class="upload-button" (click)="fileInput.click()">
									<svg width="24" height="24" viewBox="0 0 24 24" fill="none">
										<path d="M12 5v14m7-7H5" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
									</svg>
								</button>
								<input
									#fileInput
									type="file"
									accept="image/*"
									(change)="onPhotoUpload($event)"
									style="display: none;">
							</div>
						</div>
					</div>

					<div class="form-actions">
						<button
							class="save-button"
							[disabled]="isSaving()"
							(click)="saveUserProfile()">
							<svg width="20" height="20" viewBox="0 0 24 24" fill="none">
								<path d="M20 6L9 17l-5-5" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
							</svg>
							Save changes
						</button>
					</div>
				</div>

				<!-- Change Password Section -->
				<div class="form-section password-section">
					<h3 class="section-title">
						<svg width="20" height="20" viewBox="0 0 24 24" fill="none">
							<path d="M12 17v-4M7 12V9a5 5 0 1 1 10 0v3" stroke="currentColor" stroke-width="2"/>
							<rect x="5" y="11" width="14" height="10" rx="2" stroke="currentColor" stroke-width="2"/>
						</svg>
						Change password
					</h3>

					<div class="form-group">
						<label for="newPassword">New Password</label>
						<input
							type="password"
							id="newPassword"
							[(ngModel)]="passwordForm().newPassword"
							class="form-input">
					</div>

					<div class="form-group">
						<label for="confirmPassword">Confirm new password</label>
						<input
							type="password"
							id="confirmPassword"
							[(ngModel)]="passwordForm().confirmPassword"
							class="form-input">
					</div>

					<div class="form-actions">
						<button
							class="save-button"
							[disabled]="isSaving()"
							(click)="changePassword()">
							<svg width="20" height="20" viewBox="0 0 24 24" fill="none">
								<path d="M20 6L9 17l-5-5" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
							</svg>
							Save changes
						</button>
					</div>
				</div>
			</div>
		}

		<!-- Vehicle Data Tab -->
		@if (activeTab() === 'vehicle') {
			<div class="tab-content">
				<div class="form-section">
					<div class="vehicle-grid">
						<div class="vehicle-info">
							<div class="form-group">
								<label for="vehicleType">Type</label>
								<select
									id="vehicleType"
									[(ngModel)]="vehicleForm().type"
									class="form-input">
									@for (type of vehicleTypes(); track type.id) {
										<option [value]="type.id">{{ type.name }}</option>
									}
								</select>
							</div>

							<div class="form-group">
								<label for="seats">Number of seats</label>
								<input
									type="number"
									id="seats"
									[(ngModel)]="vehicleForm().numberOfSeats"
									class="form-input"
									min="1"
									max="20">
							</div>

							<div class="form-group">
								<label for="model">Model</label>
								<input
									type="text"
									id="model"
									[(ngModel)]="vehicleForm().model"
									class="form-input">
							</div>

							<div class="form-group">
								<label for="plate">Plate number</label>
								<input
									type="text"
									id="plate"
									[(ngModel)]="vehicleForm().plateNumber"
									class="form-input">
							</div>
						</div>

						<div class="additional-services">
							<h3 class="services-title">Additional services</h3>
							<div class="services-list">
								@for (service of availableServices(); track service.id) {
									<label class="service-item">
										<input
											type="checkbox"
											[checked]="isServiceEnabled(service.id)"
											(change)="toggleService(service.id)">
										<svg class="checkmark" width="20" height="20" viewBox="0 0 24 24" fill="none">
											<path d="M20 6L9 17l-5-5" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
										</svg>
										<span>{{ service.name }}</span>
									</label>
								}
							</div>
						</div>
					</div>

					<div class="form-actions">
						<button
							class="save-button"
							[disabled]="isSaving()"
							(click)="saveVehicleInfo()">
							<svg width="20" height="20" viewBox="0 0 24 24" fill="none">
								<path d="M20 6L9 17l-5-5" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
							</svg>
							Save changes
						</button>
					</div>
				</div>
			</div>
		}
	</div>
</div>
